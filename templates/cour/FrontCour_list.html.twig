{% extends 'Front_navbar_footer.html.twig' %}
{% block body %}
    <section class="pt-5 paddingBottom-100 bg-light-v2">
        <div class="container">
            <ul class="nav-item nav-item__has-dropdown">
                <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        data-toggle="dropdown">Trier Les prix</a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="{{ path('list_cour_Front') }}" class="nav-link__list">
                            Tout les prix
                        </a>
                    </li>
                    <li>
                        <a href="{{ path('listCour_ASC') }}" class="nav-link__list">
                           Prix Ascendant
                        </a>
                    </li>
                    <li>
                        <a href="{{ path('listCour_DESC')}}" class="nav-link__list">
                          Prix  Descendant
                        </a>
                    </li>

                </ul>
            </ul>

            <!--endblock examen tri -->

            <form class="w-search">
                <div class="sidebar-search">

                    <div class="input-group custom-search-form">

                        <input type="text" id="search" class="form-control pl-3" placeholder="Search here">
                    </div>
                    <!-- /input-group -->
                </div>
                <ul class="nav" id="side-menu">
                    <li>
                        <a href="#"><span class="fa arrow"></span></a>
                        <ul  class="nav " id="entitiesNav">
                        </ul>
                    </li>
                </ul>
            </form>
            <div class="row">

                {% for e in cour %}
                    <div class="col-md-6 marginTop-30">
                        <div
                                href="page-course-details.html"
                                class="card text-gray shadow-v1"
                        >
                            <a href="{{ path('cour_details',{'idcour':e.idcour}) }}"> <img
                                    class="card-img-top"
                                src="{{ asset("images/cour/#{e.img}") }} "

                                    alt=""

                            />
                            </a>
                            <div class="card-body">
                                <a href="#" class="h5"> {{ e.nom }}</a>
                                <p class="my-3">
                                    <i class="ti-user mr-2"></i>
                                    {{ e.formateur }}
                                </p>
                                <p class="mb-0">
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <i class="fas fa-star text-warning"></i>
                                    <span class="text-dark">5</span>
                                    <span>(4578)</span>
                                </p>
                            </div>
                            <div
                                    class="card-footer media align-items-center justify-content-between"
                            >
                                <ul class="list-unstyled mb-0">
                                    <li class="mb-1">
                                        <i class="ti-headphone small mr-2"></i>
                                        {{ e.niveau }}                                    </li>
                                    <li class="mb-1">
                                        <i class="ti-time small mr-2"></i>
                                        {{ e.duration}}
                                    </li>
                                </ul>
                                <h4 class="h5 text-right">
                                    <span class="text-primary"> ${{ e.prix }}</span>
                                </h4>
                            </div>
                        </div>
                    </div>
                 {% endfor %}
            </div>
            {# display navigation #}
            <div class="navigation">
                {{ knp_pagination_render(cour) }}
            </div>
            <!--END row-->
        </div>
        <!-- END container-->
    </section>
    <script src="{{ asset('frontoffice/assets/vendor/jquery-3.5.1/jquery-3.5.1.min.js') }}"></script>
    <script>
        jQuery(document).ready(function() {
            var searchRequest = null;
            $("#search").keyup(function() {
                var minlength = 1;
                var that = this;
                var value = $(this).val();
                var entitySelector = $("#entitiesNav").html('');
                if (value.length >= minlength ) {
                    if (searchRequest != null)
                        searchRequest.abort();
                    searchRequest = $.ajax({
                        type: "GET",
                        url: "{{ path('ajaxsearch') }}",
                        data: {
                            'q' : value
                        },
                        dataType: "text",
                        success: function(msg){
                            if (value===$(that).val()) {
                                var result = JSON.parse(msg);
                                $.each(result, function(key, arr) {
                                    $.each(arr, function(id, value) {
                                        if (key === 'cour') {
                                            if (id !== 'error') {
                                                console.log(value);
                                                console.log(id);
                                                entitySelector.append('<ul><li>' +
                                                    '<a class="nav-link__list" href="http://127.0.0.1:8000/cour/courDetails/'+id+'">'+value[0] +'</a></li></ul><br>');
                                            } else {
                                                entitySelector.append('<li class="errorLi">'+value+'</li>');
                                            }
                                        }
                                    });
                                });
                            }
                        }
                    });
                }
            });
        });
    </script>
{% endblock %}